<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Aviation Torque Converter • Ciphracore</title>

  <!-- Social preview for easy sharing -->
  <meta property="og:title" content="Aviation Torque Converter" />
  <meta property="og:description" content="Fast, bilingual torque conversions (lb‑in, lb‑ft, N·m, kgf·m, oz‑in, dN·m, N·cm). One‑file, mobile‑ready." />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#667eea" />
  <!-- Production canonical URL -->
  <link rel="canonical" href="https://amttorque.netlify.app/" />

  <style>
    :root {
      --bg1: #667eea;
      --bg2: #764ba2;
      --card-bg: #fff;
      --muted-bg: #f8f9fa;
      --txt-main: #333;
      --txt-sub: #555;
      --accent: #667eea;
      --danger: #dc3545;
      --border: #e6e8ec;
    }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      max-width: 860px;
      margin: 0 auto;
      padding: 16px; /* tighter mobile padding */
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      min-height: 100vh;
    }
    .calculator {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.20);
      position: relative;
    }
    h1 {
      text-align: center;
      color: var(--txt-main);
      margin: 8px 0 18px;
      font-size: clamp(1.4rem, 2.6vw, 2.2rem);
    }
    .btn {
      border: 2px solid var(--accent);
      background: #fff;
      color: var(--accent);
      font-weight: 700;
      padding: 10px 14px;
      border-radius: 999px;
      cursor: pointer;
      transition: .2s ease;
    }
    .btn:hover { background: var(--accent); color: #fff; }

    .input-section {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 16px;
      padding: 16px;
      background: var(--muted-bg);
      border-radius: 12px;
    }
    @media (min-width: 560px) {
      .input-section { grid-template-columns: 2fr 1fr; }
    }

    .input-group { display: flex; flex-direction: column; }
    label { font-weight: 700; margin-bottom: 6px; color: var(--txt-sub); }

    input[type="number"] {
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color .2s;
    }
    input[type="number"]:focus { outline: none; border-color: var(--accent); }

    select {
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      background: white;
      cursor: pointer;
    }

    .options-row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin: 8px 0 0; }
    .toggle {
      display:inline-flex; align-items:center; gap:8px; padding: 8px 12px; border-radius: 999px; background: #eef2ff; color:#3f51b5; font-weight:600; cursor:pointer;
    }

    .results { background: var(--muted-bg); border-radius: 12px; padding: 16px; margin-top: 10px; }
    .result-row { display:flex; justify-content: space-between; align-items:center; gap:10px; padding: 10px 0; border-bottom: 1px solid #eee; }
    .result-row:last-child { border-bottom: none; }
    .unit-name { font-weight: 700; color: var(--txt-sub); }
    .unit-value { color: var(--txt-main); font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .row-actions { display:flex; gap:6px; }
    .row-btn { border:1px solid var(--border); background:#fff; border-radius:8px; padding:6px 8px; cursor:pointer; font-size:12px; }

    .actions { display:flex; gap:10px; flex-wrap:wrap; margin-top: 14px; }
    .primary { background: var(--accent); color:#fff; border-color: var(--accent); }
    .danger { background: var(--danger); color:#fff; border-color: var(--danger); }

    .info { background: #e3f2fd; border-left: 4px solid #2196f3; padding: 12px; margin-top: 14px; border-radius: 8px; font-size: 0.95rem; }
    .footer { text-align:center; margin-top: 18px; padding-top: 14px; border-top: 1px solid #eee; color:#888; font-size: 12px; opacity: .8; }
    .footer a { color: inherit; text-decoration: none; }
  </style>
</head>
<body>
  <div class="calculator" role="application" aria-label="Aviation Torque Converter">
    <h1 id="title">✈️ Aviation Torque Converter</h1>

    <div class="input-section">
      <div class="input-group">
        <label for="inputValue" id="inputLabel">Input Value</label>
        <input type="number" id="inputValue" step="0.1" inputmode="decimal" placeholder="Enter torque value" aria-describedby="unitsHelp" />
        <div class="options-row">
          <label class="toggle"><input type="checkbox" id="specMode"/> <span id="specModeLbl">Spec Mode</span></label>
          <label class="toggle"><input type="checkbox" id="blockNeg" checked/> <span id="blockNegLbl">No negative values</span></label>
        </div>
      </div>
      <div class="input-group">
        <label for="inputUnit" id="unitLabel">From Unit</label>
        <select id="inputUnit">
          <option value="lb-ft">lb-ft (Pound-feet)</option>
          <option value="lb-in">lb-in (Pound-inches)</option>
          <option value="N-m">N⋅m (Newton-meters)</option>
          <option value="kgf-m">kgf⋅m (Kilogram-force meters)</option>
          <option value="oz-in">oz-in (Ounce-inches)</option>
          <option value="dN-m">dN⋅m (Decinewton-meters)</option>
          <option value="N-cm">N⋅cm (Newton-centimeters)</option>
        </select>
        <small id="unitsHelp" style="color:#666">Tip: kgf⋅m is kilogram‑force meter (torque), not kg·m² (inertia).</small>
      </div>
    </div>

    <div class="results" id="results" aria-live="polite" aria-atomic="true">
      <h3 style="margin-top:0;color:#333" id="resultsTitle">Conversion Results</h3>
      <div id="resultsList"></div>
      <div class="actions">
        <button class="btn primary" id="copyAll" type="button">Copy All</button>
        <button class="btn danger" id="clearBtn" type="button">Clear All</button>
      </div>
    </div>

    <div class="info" id="aviationNotes">
      <strong id="notesTitle">Aviation Torque Notes</strong><br/>
      <span id="note1">• Most aviation fasteners specify torque in lb‑in or N⋅m.</span><br/>
      <span id="note2">• Always refer to manufacturer specifications.</span><br/>
      <span id="note3">• Use calibrated torque wrenches for critical components.</span><br/>
      <span id="note4">• Factor in thread condition and lubrication.</span>
    </div>

    <!-- Share buttons moved to bottom -->
    <div class="actions" style="margin-top:20px; justify-content:center;">
      <button class="btn" id="langToggle" type="button">ES</button>
      <button class="btn" id="shareBtn" type="button">Share</button>
    </div>

    <div class="footer">
      <span id="copyright">© Ciphracore Systems LLC — All rights reserved</span><br/>
      <a href="mailto:ciphracore@protonmail.com">ciphracore@protonmail.com</a>
    </div>
  </div>

  <script>
    // ————— Internationalization —————
    const translations = {
      en: {
        title: "✈️ Aviation Torque Converter",
        inputLabel: "Input Value",
        unitLabel: "From Unit",
        resultsTitle: "Conversion Results",
        clearBtn: "Clear All",
        copyAll: "Copy All",
        specMode: "Spec Mode",
        blockNeg: "No negative values",
        notesTitle: "Aviation Torque Notes",
        note1: "• Most aviation fasteners specify torque in lb‑in or N⋅m",
        note2: "• Always refer to manufacturer specifications",
        note3: "• Use calibrated torque wrenches for critical components",
        note4: "• Factor in thread condition and lubrication",
        copyright: "© Ciphracore Systems LLC — All rights reserved",
        placeholder: "Enter torque value",
        emptyResults: "Enter a value to see conversions",
        share: "Share"
      },
      es: {
        title: "✈️ Convertidor de Torque Aeronáutico",
        inputLabel: "Valor de Entrada",
        unitLabel: "Desde Unidad",
        resultsTitle: "Resultados de Conversión",
        clearBtn: "Limpiar Todo",
        copyAll: "Copiar Todo",
        specMode: "Modo Especificación",
        blockNeg: "Sin valores negativos",
        notesTitle: "Notas de Torque Aeronáutico",
        note1: "• La mayoría de sujetadores aeronáuticos especifican torque en lb‑in o N⋅m",
        note2: "• Siempre consulte las especificaciones del fabricante",
        note3: "• Use llaves de torque calibradas para componentes críticos",
        note4: "• Considere la condición de la rosca y la lubricación",
        copyright: "© Ciphracore Systems LLC — Todos los derechos reservados",
        placeholder: "Ingrese valor de torque",
        emptyResults: "Ingrese un valor para ver conversiones",
        share: "Compartir"
      }
    };

    let currentLanguage = localStorage.getItem('torqueLang') || 'en';
    const $ = (sel) => document.querySelector(sel);

    function updateLanguage() {
      const t = translations[currentLanguage];
      $('#title').textContent = t.title;
      $('#inputLabel').textContent = t.inputLabel;
      $('#unitLabel').textContent = t.unitLabel;
      $('#resultsTitle').textContent = t.resultsTitle;
      $('#clearBtn').textContent = t.clearBtn;
      $('#copyAll').textContent = t.copyAll;
      $('#notesTitle').textContent = t.notesTitle;
      $('#note1').textContent = t.note1;
      $('#note2').textContent = t.note2;
      $('#note3').textContent = t.note3;
      $('#note4').textContent = t.note4;
      $('#copyright').textContent = t.copyright;
      $('#inputValue').placeholder = t.placeholder;
      $('#langToggle').textContent = currentLanguage === 'en' ? 'ES' : 'EN';
      $('#shareBtn').textContent = t.share;
      $('#specModeLbl').textContent = t.specMode;
      $('#blockNegLbl').textContent = t.blockNeg;
      if (state.isEmpty) renderEmpty();
    }

    $('#langToggle').addEventListener('click', () => {
      currentLanguage = currentLanguage === 'en' ? 'es' : 'en';
      localStorage.setItem('torqueLang', currentLanguage);
      updateLanguage();
    });

    // ————— Units & Conversion —————
    // Base: Newton-meter
    const toNm = {
      'lb-ft': 1.3558179483,
      'lb-in': 0.1129848290,
      'N-m': 1.0,
      'kgf-m': 9.80665,       // kilogram-force meter
      'oz-in': 0.0070615518,
      'dN-m': 0.1,
      'N-cm': 0.01
    };

    const unitNames = {
      'lb-ft': 'Pound-feet (lb-ft)',
      'lb-in': 'Pound-inches (lb-in)',
      'N-m': 'Newton-meters (N⋅m)',
      'kgf-m': 'Kilogram-force meters (kgf⋅m)',
      'oz-in': 'Ounce-inches (oz-in)',
      'dN-m': 'Decinewton-meters (dN⋅m)',
      'N-cm': 'Newton-centimeters (N⋅cm)'
    };

    const fromNm = Object.fromEntries(Object.entries(toNm).map(([k,v]) => [k, 1/v]));

    const state = { isEmpty: true };

    function decimalsFromInput(raw) {
      // Preserve user-entered decimals for output precision
      const s = String(raw).trim();
      if (!s || /e|E/.test(s)) return 3; // fallback for scientific/empty
      const m = s.match(/^(?:-)?(\d+)(?:\.(\d+))?$/);
      if (!m) return 3;
      return (m[2] ? m[2].length : 0);
    }

    function formatBySpec(value, unit) {
      // OEM-style rounding when Spec Mode ON
      // N-m & N-cm: 0.1; lb-in: 1; lb-ft: 0.1; kgf-m: 0.1; oz-in: 1; dN-m: 0.1
      const map = { 'N-m':1, 'N-cm':1, 'lb-in':0, 'lb-ft':1, 'kgf-m':1, 'oz-in':0, 'dN-m':1 };
      const d = map[unit] ?? 3;
      return value.toFixed(d);
    }

    function makeRows(nm, decimals, specOn) {
      return Object.entries(fromNm).map(([unit, factor]) => {
        const val = nm * factor;
        const out = specOn ? formatBySpec(val, unit) : val.toFixed(Math.min(6, Math.max(0, decimals)));
        return `<div class="result-row" role="row">
          <span class="unit-name">${unitNames[unit]}:</span>
          <span class="unit-value">${out}</span>
          <span class="row-actions">
            <button class="row-btn" data-copy="${out} ${unit}">Copy</button>
          </span>
        </div>`;
      }).join('');
    }

    function renderEmpty() {
      state.isEmpty = true;
      const t = translations[currentLanguage];
      $('#resultsList').innerHTML = `<p style="color:#999;font-style:italic;">${t.emptyResults}</p>`;
    }

    const debounce = (fn, ms) => { let to; return (...a) => { clearTimeout(to); to = setTimeout(() => fn(...a), ms); }; };

    function compute() {
      const raw = $('#inputValue').value;
      const v = Number(raw);
      const blockNeg = $('#blockNeg').checked;

      if (!Number.isFinite(v) || (blockNeg && v < 0)) {
        return renderEmpty();
      }
      state.isEmpty = false;

      const unit = $('#inputUnit').value;
      const nm = v * toNm[unit];
      const decimals = decimalsFromInput(raw);
      const specOn = $('#specMode').checked;

      $('#resultsList').innerHTML = makeRows(nm, decimals, specOn);
    }

    const run = debounce(compute, 180);

    // ————— Event wiring —————
    $('#inputValue').addEventListener('input', run);
    $('#inputUnit').addEventListener('change', compute);
    $('#specMode').addEventListener('change', compute);
    $('#blockNeg').addEventListener('change', compute);

    $('#clearBtn').addEventListener('click', () => {
      $('#inputValue').value = '';
      renderEmpty();
      $('#inputValue').focus();
    });

    // Copy-per-row and copy-all
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('button');
      if (!btn) return;
      if (btn.dataset.copy) {
        navigator.clipboard?.writeText(btn.dataset.copy);
        btn.textContent = 'Copied';
        setTimeout(() => (btn.textContent = 'Copy'), 900);
      }
    });

    $('#copyAll').addEventListener('click', () => {
      const rows = [...document.querySelectorAll('.result-row')].map(r => r.innerText.replace(/\n/g,' ').trim());
      const txt = rows.join('\n');
      navigator.clipboard?.writeText(txt);
      const b = $('#copyAll');
      const label = b.textContent;
      b.textContent = 'Copied';
      setTimeout(()=> b.textContent = label, 1100);
    });

    // ————— Sharing —————
    $('#shareBtn').addEventListener('click', async () => {
      const url = (function(){
        const canonical = document.querySelector('link[rel="canonical"]')?.href;
        const base = canonical || window.location.href;
        const sep = base.includes('?') ? '&' : '?';
        return `${base}${sep}src=share`;
      })();
      if (navigator.share) {
        try { await navigator.share({ title: 'Aviation Torque Converter', url }); } catch (_) {}
      } else {
        navigator.clipboard?.writeText(url);
        alert('Link copied. Paste into any app.');
      }
    });

    // ————— Init —————
    updateLanguage();
    renderEmpty();
  </script>
</body>
</html>